<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ØµØ§Ù†Ø¹ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¬ÙˆÙ„Ø§Øª</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- ØµÙØ­Ø© ØªØ³ØªØ®Ø¯Ù… Cairo Ù„Ù„Ù†ØµÙˆØµ Ø§Ù„Ø¹Ø§Ù…Ø©ØŒ ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± Tajawal -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Tajawal:wght@500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --ink:#0f172a; --muted:#64748b; --line:#e2e8f0; --card:#ffffff;
      --ok:#16a34a; --ok-press:#15803d; --bg:#f8fafc; --chip:#f1f5f9;
      --sun:#fff7ed; --sky:#e0f2fe; --night:#0b1020; --vio:#1f1240; --star:#e5e7eb;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:'Cairo', system-ui, Segoe UI, Arial, sans-serif; background:var(--bg); color:var(--ink)}
    .wrap{max-width:880px; margin-inline:auto; padding:16px;}

    /* Ø®Ù„ÙÙŠØ© ØµØ¨Ø§Ø­/Ù…Ø³Ø§Ø¡ */
    .hero{border-radius:16px; padding:18px; margin:10px 0 16px; position:relative; overflow:hidden}
    .hero.morning{background:linear-gradient(180deg, var(--sky), #ffffff)}
    .hero.morning:after{content:""; position:absolute; inset:auto 18px  -24px auto; width:120px; height:120px; background:radial-gradient(circle,#ffe8a3,#ffd67a); border-radius:50%; opacity:.7}
    .hero.evening{background:linear-gradient(180deg, var(--vio), var(--night)); color:#fff}
    .hero.evening .sub{color:#c7d2fe}
    .hero.evening:after{content:""; position:absolute; inset:8px 12px auto auto; width:2px; height:2px; background:transparent; box-shadow: 0 0 0 0 #000,
        12px 8px 0 0 var(--star), 24px 10px 0 0 var(--star), 36px 6px 0 0 var(--star), 48px 12px 0 0 var(--star), 60px 9px 0 0 var(--star);
    }
    h1{margin:0 0 6px; font-size:20px}
    .sub{margin:0; font-size:14px; color:var(--muted)}

    .card{background:var(--card); border:1px solid var(--line); border-radius:14px; padding:14px;}
    .grid{display:grid; gap:10px}
    @media (min-width:680px){ .grid-3{ grid-template-columns: repeat(3, 1fr); } }

    label{font-size:13px; color:var(--muted); display:block; margin-bottom:6px}
    input[type="text"], textarea{
      width:100%; border:1px solid var(--line); border-radius:10px; padding:10px; font:inherit; background:#fff;
    }
    textarea{min-height:88px; resize:vertical}

    .day{background:var(--card); border:1px solid var(--line); border-radius:14px; padding:12px}
    .day h3{margin:0 0 8px; font-size:16px}
    .muted{color:var(--muted); font-size:12px}

    .actions{display:flex; gap:8px; flex-wrap:wrap; justify-content:space-between; align-items:center}
    .btn{appearance:none; border:0; border-radius:12px; padding:12px 16px; cursor:pointer; font-weight:700; font-family:'Tajawal', system-ui, Arial, sans-serif}
    .btn-primary{background:var(--ok); color:#fff}
    .btn-primary:active{background:var(--ok-press)}
    .btn-ghost{background:#fff; border:1px solid var(--line)}

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù…ÙˆØ¨Ø§ÙŠÙ„ */
    @media (max-width:420px){ h1{font-size:18px} .btn{width:100%} }
  </style>
</head>
<body>
  <div class="wrap">
    <section id="hero" class="hero">
      <h1 id="heroTitle">ØµØ§Ù†Ø¹ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¬ÙˆÙ„Ø§Øª</h1>
      <p class="sub" id="heroSub">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ</p>
    </section>

    <section class="card" style="margin-bottom:10px">
      <h2 style="margin:0 0 10px; font-size:16px">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h2>
      <div class="grid grid-3">
        <div>
          <label>Ø§Ù„Ø­ØµØ©</label>
          <input id="period" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©" />
        </div>
        <div>
          <label>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</label>
          <input id="week" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø³Ø§Ø¨Ø¹" />
        </div>
        <div>
          <label>Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
          <input id="term" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø£ÙˆÙ„" />
        </div>
      </div>
      <p class="muted" style="margin-top:6px">Ø§Ø³Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©: <strong>Ø§Ø¨ØªØ³Ø§Ù… Ù‚Ø§Ø³Ù… Ø§Ù„ÙÙŠÙÙŠ</strong> (ÙŠÙÙ…Ù„Ø£ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„ØªÙ‚Ø±ÙŠØ±)</p>
    </section>

    <section class="grid" style="margin-bottom:12px">
      <div class="day">
        <h3>Ø§Ù„Ø£Ø­Ø¯</h3>
        <div class="grid">
          <div>
            <label>Ø§Ù„ÙØµÙ„</label>
            <input id="sun_class" type="text" placeholder="Ù…Ø«Ø§Ù„: 3/Ø¨" />
          </div>
          <div>
            <label>Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¬ÙˆÙ„Ø©</label>
            <textarea id="sun_follow" placeholder="Ù…Ø§Ø°Ø§ ØªÙ…Øª Ù…ØªØ§Ø¨Ø¹ØªÙ‡ØŸ"></textarea>
          </div>
          <div>
            <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
            <textarea id="sun_note" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©"></textarea>
          </div>
        </div>
      </div>

      <div class="day">
        <h3>Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†</h3>
        <div class="grid">
          <div>
            <label>Ø§Ù„ÙØµÙ„</label>
            <input id="mon_class" type="text" />
          </div>
          <div>
            <label>Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¬ÙˆÙ„Ø©</label>
            <textarea id="mon_follow"></textarea>
          </div>
          <div>
            <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
            <textarea id="mon_note"></textarea>
          </div>
        </div>
      </div>

      <div class="day">
        <h3>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</h3>
        <div class="grid">
          <div>
            <label>Ø§Ù„ÙØµÙ„</label>
            <input id="tue_class" type="text" />
          </div>
          <div>
            <label>Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¬ÙˆÙ„Ø©</label>
            <textarea id="tue_follow"></textarea>
          </div>
          <div>
            <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
            <textarea id="tue_note"></textarea>
          </div>
        </div>
      </div>
    </section>

    <div class="actions">
      <span class="muted">Ø³ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ (Ø§Ù„Ø£Ø­Ø¯ â†’ Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡ Ù…Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠ).</span>
      <button class="btn btn-primary" id="export">ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± PDF</button>
    </div>
  </div>

  <script>
    // ØªØ­ÙŠØ© ØµØ¨Ø§Ø­/Ù…Ø³Ø§Ø¡ + Ø®Ù„ÙÙŠØ©
    (function(){
      const hero = document.getElementById('hero');
      const title = document.getElementById('heroTitle');
      const sub = document.getElementById('heroSub');
      const h = new Date().getHours();
      const morning = (h >= 5 && h < 17);
      if(morning){
        hero.classList.add('morning');
        sub.textContent = 'ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ± Ø§Ø¨ØªØ³Ø§Ù… â˜€ï¸';
      }else{
        hero.classList.add('evening');
        sub.textContent = 'Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ± Ø§Ø¨ØªØ³Ø§Ù… ğŸŒ™';
      }
      title.textContent = 'ØµØ§Ù†Ø¹ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¬ÙˆÙ„Ø§Øª';
    })();

    const $ = (s)=>document.querySelector(s);

    $('#export').onclick = async () => {
      const fd = new FormData();
      fd.append('period', $('#period').value.trim());
      fd.append('week', $('#week').value.trim());
      fd.append('term', $('#term').value.trim());

      fd.append('sun_class',  $('#sun_class').value.trim());
      fd.append('sun_follow', $('#sun_follow').value.trim());
      fd.append('sun_note',   $('#sun_note').value.trim());

      fd.append('mon_class',  $('#mon_class').value.trim());
      fd.append('mon_follow', $('#mon_follow').value.trim());
      fd.append('mon_note',   $('#mon_note').value.trim());

      fd.append('tue_class',  $('#tue_class').value.trim());
      fd.append('tue_follow', $('#tue_follow').value.trim());
      fd.append('tue_note',   $('#tue_note').value.trim());

      const btn = $('#export');
      btn.disabled = true; const prev = btn.textContent; btn.textContent = 'Ø¬Ø§Ø±Ù Ø¥Ù†Ø´Ø§Ø¡ PDF...';
      try{
        const res = await fetch('/api/pdf', { method:'POST', body: fd });
        if(!res.ok){
          alert('ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ PDF');
          return;
        }
        const blob = await res.blob();
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ø¬ÙˆÙ„Ø§Øª_${Date.now()}.pdf`;
        document.body.appendChild(a); a.click(); a.remove();
        URL.revokeObjectURL(url);
      }catch(e){
        alert('ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…');
      }finally{
        btn.disabled = false; btn.textContent = prev;
      }
    };
  </script>
</body>
</html>
